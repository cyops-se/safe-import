(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["views-BaselineDNS"],{"417f":function(e,t,a){"use strict";a("8fc2")},"8fc2":function(e,t,a){},cc8e:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-tabs",{attrs:{"align-with-title":""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tabs-slider",{attrs:{color:"yellow"}}),a("v-tab",{key:"GREY"},[e._v(" GREY ")]),a("v-tab",{key:"WHITE"},[e._v(" WHITE ")]),a("v-tab",{key:"BLACK"},[e._v(" BLACK ")]),a("v-spacer"),a("v-text-field",{staticClass:"my-auto mr-4",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":"",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),a("v-btn",{staticClass:"my-auto mr-4",attrs:{color:"primary",dark:""},on:{click:e.pruneEntries}},[e._v(" Prune entries ")])],1)],1),a("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tab-item",{key:"GREY"},[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.greyitems,search:e.search,"items-per-page":15},scopedSlots:e._u([{key:"item.actions",fn:function(t){var i=t.item;return[a("v-icon",{staticClass:"mr-2",on:{click:function(t){return e.makeWhite(i)}}},[e._v(" mdi-shield-check ")]),a("v-icon",{staticClass:"mr-2",on:{click:function(t){return e.makeBlack(i)}}},[e._v(" mdi-shield-off-outline ")]),a("v-icon",{on:{click:function(t){return e.deleteGrey(i)}}},[e._v(" mdi-trash-can ")])]}}])})],1),a("v-tab-item",{key:"WHITE"},[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.whiteheaders,items:e.whiteitems,search:e.search,"items-per-page":15},scopedSlots:e._u([{key:"item.allowed",fn:function(t){var i=t.item;return[a("v-simple-checkbox",{on:{click:function(t){return e.saveItem(i)}},model:{value:i.allowed,callback:function(t){e.$set(i,"allowed",t)},expression:"item.allowed"}})]}},{key:"item.actions",fn:function(t){var i=t.item;return[a("v-icon",{staticClass:"mr-2",on:{click:function(t){return e.editItem(i)}}},[e._v(" mdi-pencil ")]),a("v-icon",{on:{click:function(t){return e.makeGrey(i)}}},[e._v(" mdi-undo-variant ")])]}}])})],1),a("v-tab-item",{key:"BLACK"},[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.blackitems,search:e.search,"items-per-page":15},scopedSlots:e._u([{key:"item.actions",fn:function(t){var i=t.item;return[a("v-icon",{staticClass:"mr-2",on:{click:function(t){return e.editItem(i)}}},[e._v(" mdi-pencil ")]),a("v-icon",{on:{click:function(t){return e.makeGrey(i)}}},[e._v(" mdi-undo-variant ")])]}}])})],1)],1),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"text-h5"},[e._v("DNS item")])]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{label:"Query",outlined:"","hide-details":""},model:{value:e.editedItem.query,callback:function(t){e.$set(e.editedItem,"query",t)},expression:"editedItem.query"}})],1),a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{label:"Pattern",outlined:"","hide-details":""},model:{value:e.editedItem.matchquery,callback:function(t){e.$set(e.editedItem,"matchquery",t)},expression:"editedItem.matchquery"}})],1),"white"===e.editedItem.class?a("v-col",{attrs:{cols:"12"}},[a("v-checkbox",{staticClass:"mt-n3",attrs:{label:"Allow through gateway","hide-details":"",value:!e.editedItem||e.editedItem.allowed},model:{value:e.editedItem.allowed,callback:function(t){e.$set(e.editedItem,"allowed",t)},expression:"editedItem.allowed"}})],1):e._e()],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.close}},[e._v(" Cancel ")]),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.save}},[e._v(" Save ")])],1)],1)],1)],1)},n=[],s=(a("159b"),a("ac1f"),a("5319"),a("c5fa")),c={name:"BaselineDNS",data:function(){return{tab:null,dialog:!1,dialogDelete:!1,search:"",loading:!1,headers:[{text:"Time",align:"start",filterable:!0,value:"timemod",width:150},{text:"IP",value:"fromip",width:"10%"},{text:"Query",value:"query",width:"40%"},{text:"Match query",value:"matchquery",width:"40%"},{text:"Count",value:"count",width:"10%"},{text:"Actions",value:"actions",width:1,sortable:!1}],whiteheaders:[{text:"Time",align:"start",filterable:!0,value:"timemod",width:150},{text:"IP",value:"fromip",width:"10%"},{text:"Query",value:"query",width:"40%"},{text:"Match query",value:"matchquery",width:"40%"},{text:"Count",value:"count",width:"10%"},{text:"Allowed",value:"allowed",width:"120"},{text:"Actions",value:"actions",width:1,sortable:!1}],items:[],greyitems:[],whiteitems:[],blackitems:[],editedIndex:-1,editedItem:{fullname:"",email:""},defaultItem:{fullname:"",email:""}}},created:function(){this.update()},methods:{initialize:function(){},update:function(){var e=this;e.greyitems=[],e.whiteitems=[],e.blackitems=[],this.loading=!0,s["a"].get("dns").then((function(t){e.items=JSON.parse(t.data.items.payload),e.items.forEach((function(t){var a=new Date(t.lastseen);t.lasttime=a.toLocaleString()+"."+a.getMilliseconds(),t.timemod=t.CreatedAt.replace("T"," ").replace("Z","").substring(0,19),""===t.class||"grey"===t.class?e.greyitems.push(t):"white"===t.class?(e.whiteitems.push(t),t.allowed&&(t.allow='<i class="nb-checkmark"></i>')):e.blackitems.push(t)})),e.loading=!1})).catch((function(e){console.log("ERROR response: "+e)}))},makeWhite:function(e){var t=this,a=this;e.class="white",s["a"].put("dns/"+e.ID,e).then((function(e){a.update(),t.$notification.success("DNS entry moved to white list!")})).catch((function(e){console.log("ERROR response: "+e)}))},makeBlack:function(e){var t=this,a=this;e.class="black",s["a"].put("dns/"+e.ID,e).then((function(e){a.update(),t.$notification.success("DNS entry moved to black list!")})).catch((function(e){console.log("ERROR response: "+e)}))},makeGrey:function(e){var t=this,a=this;e.class="grey",s["a"].put("dns/"+e.ID,e).then((function(e){a.update(),t.$notification.success("DNS entry moved to grey list!")})).catch((function(e){console.log("ERROR response: "+e)}))},deleteGrey:function(e){var t=this,a=this;s["a"].delete("dns/"+e.ID).then((function(e){console.log("response: "+JSON.stringify(e)),a.update(),t.$notification.success("DNS entry deleted from grey list!")})).catch((function(e){console.log("ERROR response: "+e)}))},pruneEntries:function(){var e=this,t=this;s["a"].get("dns/prune").then((function(a){t.update(),e.$notification.success("DNS entries pruned!")})).catch((function(e){console.log("ERROR response: "+e)}))},editItem:function(e){this.editedIndex=this.items.indexOf(e),this.editedItem=Object.assign({},e),console.log("editedItem: "+JSON.stringify(this.editedItem)),this.dialog=!0},close:function(){var e=this;this.dialog=!1,this.$nextTick((function(){e.editedItem=Object.assign({},e.defaultItem),e.editedIndex=-1}))},save:function(){var e=this,t=this.editedItem;this.editedIndex>-1&&(Object.assign(this.items[this.editedIndex],this.editedItem),s["a"].put("dns/"+this.editedIndex.ID,this.editedItem).then((function(t){e.$notification.success("DNS entry updated!")})).catch((function(a){e.$notification.error("Failed to update DNS entry!"+a+", "+JSON.stringify(t))}))),this.close()},saveItem:function(e){var t=this;s["a"].put("dns/"+e.ID,e).then((function(e){t.$notification.success("DNS entry updated!")})).catch((function(e){t.$notification.error("Failed to update DNS entry!")})),this.close()}}},o=c,l=(a("417f"),a("2877")),r=a("6544"),d=a.n(r),u=a("8336"),m=a("b0af"),h=a("99d9"),v=a("ac7c"),f=a("62ad"),p=a("a523"),b=a("8fea"),k=a("169a"),y=a("132d"),w=a("0fd9"),g=a("9e88"),I=a("2fa4"),x=a("71a3"),C=a("c671"),S=a("fe57"),D=a("aac8"),R=a("9a96"),V=a("8654"),_=a("71d9"),T=Object(l["a"])(o,i,n,!1,null,null,null);t["default"]=T.exports;d()(T,{VBtn:u["a"],VCard:m["a"],VCardActions:h["a"],VCardText:h["b"],VCardTitle:h["c"],VCheckbox:v["a"],VCol:f["a"],VContainer:p["a"],VDataTable:b["a"],VDialog:k["a"],VIcon:y["a"],VRow:w["a"],VSimpleCheckbox:g["a"],VSpacer:I["a"],VTab:x["a"],VTabItem:C["a"],VTabs:S["a"],VTabsItems:D["a"],VTabsSlider:R["a"],VTextField:V["a"],VToolbar:_["a"]})}}]);
//# sourceMappingURL=views-BaselineDNS.8c7340d6.js.map