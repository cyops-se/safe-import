(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["views-BaselineHTTP"],{b30d:function(t,e,a){"use strict";a("ef52")},b63b:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-tabs",{attrs:{"align-with-title":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tabs-slider",{attrs:{color:"yellow"}}),a("v-tab",{key:"GREY"},[t._v(" GREY ")]),a("v-tab",{key:"WHITE"},[t._v(" WHITE ")]),a("v-tab",{key:"BLACK"},[t._v(" BLACK ")]),a("v-spacer"),a("v-text-field",{staticClass:"my-auto mr-4",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":"",clearable:""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),a("v-btn",{staticClass:"my-auto mr-4",attrs:{color:"primary",dark:""},on:{click:t.pruneEntries}},[t._v(" Prune entries ")])],1)],1),a("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("v-tab-item",{key:"GREY"},[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.greyitems,search:t.search,"items-per-page":15},scopedSlots:t._u([{key:"item.actions",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mr-2",on:{click:function(e){return t.makeWhite(i)}}},[t._v(" mdi-shield-check ")]),a("v-icon",{staticClass:"mr-2",on:{click:function(e){return t.makeBlack(i)}}},[t._v(" mdi-shield-off-outline ")]),a("v-icon",{on:{click:function(e){return t.deleteGrey(i)}}},[t._v(" mdi-trash-can ")])]}}])})],1),a("v-tab-item",{key:"WHITE"},[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.whiteheaders,items:t.whiteitems,search:t.search,"items-per-page":15},scopedSlots:t._u([{key:"item.allowed",fn:function(e){var i=e.item;return[a("v-simple-checkbox",{on:{click:function(e){return t.saveItem(i)}},model:{value:i.allowed,callback:function(e){t.$set(i,"allowed",e)},expression:"item.allowed"}})]}},{key:"item.noscan",fn:function(e){var i=e.item;return[a("v-simple-checkbox",{on:{click:function(e){return t.saveItem(i)}},model:{value:i.noscan,callback:function(e){t.$set(i,"noscan",e)},expression:"item.noscan"}})]}},{key:"item.actions",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mr-2",on:{click:function(e){return t.editItem(i)}}},[t._v(" mdi-pencil ")]),a("v-icon",{on:{click:function(e){return t.makeGrey(i)}}},[t._v(" mdi-undo-variant ")])]}}])})],1),a("v-tab-item",{key:"BLACK"},[a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.blackitems,search:t.search,"items-per-page":15},scopedSlots:t._u([{key:"item.actions",fn:function(e){var i=e.item;return[a("v-icon",{staticClass:"mr-2",on:{click:function(e){return t.editItem(i)}}},[t._v(" mdi-pencil ")]),a("v-icon",{on:{click:function(e){return t.makeGrey(i)}}},[t._v(" mdi-undo-variant ")])]}}])})],1)],1),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"text-h5"},[t._v("DNS item")])]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{label:"Query",outlined:"","hide-details":""},model:{value:t.editedItem.url,callback:function(e){t.$set(t.editedItem,"url",e)},expression:"editedItem.url"}})],1),a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{label:"Pattern",outlined:"","hide-details":""},model:{value:t.editedItem.matchurl,callback:function(e){t.$set(t.editedItem,"matchurl",e)},expression:"editedItem.matchurl"}})],1),"white"===t.editedItem.class?a("v-col",{attrs:{cols:"12"}},[a("v-checkbox",{staticClass:"mt-n3",attrs:{label:"Allow through gateway","hide-details":"",value:!t.editedItem||t.editedItem.allowed},model:{value:t.editedItem.allowed,callback:function(e){t.$set(t.editedItem,"allowed",e)},expression:"editedItem.allowed"}})],1):t._e()],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.close}},[t._v(" Cancel ")]),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.save}},[t._v(" Save ")])],1)],1)],1)],1)},n=[],s=(a("159b"),a("ac1f"),a("5319"),a("c5fa")),c={name:"BaselineHTTP",data:function(){return{tab:null,dialog:!1,dialogDelete:!1,search:"",loading:!1,headers:[{text:"Time",align:"start",filterable:!0,value:"timemod",width:"150"},{text:"IP",value:"fromip",width:"10%"},{text:"Method",value:"method",width:"70"},{text:"URL",value:"url",width:"50%"},{text:"Count",value:"count",width:"10%"},{text:"Actions",value:"actions",width:1,sortable:!1}],whiteheaders:[{text:"Time",align:"start",filterable:!0,value:"timemod",width:"150"},{text:"IP",value:"fromip",width:"10%"},{text:"Method",value:"method",width:"100"},{text:"URL",value:"url",width:"40%"},{text:"Count",value:"count",width:"100"},{text:"Allowed",value:"allowed",width:"120",sortable:!1},{text:"Exclude from scan",value:"noscan",width:"100",sortable:!1},{text:"Actions",value:"actions",width:1,sortable:!1}],items:[],greyitems:[],whiteitems:[],blackitems:[],editedIndex:-1,editedItem:{fullname:"",email:""},defaultItem:{fullname:"",email:""}}},created:function(){this.update()},methods:{initialize:function(){},update:function(){var t=this;t.greyitems=[],t.whiteitems=[],t.blackitems=[],this.loading=!0,s["a"].get("http").then((function(e){t.items=JSON.parse(e.data.items.payload),t.items.forEach((function(e){var a=new Date(e.lastseen);e.lasttime=a.toLocaleString()+"."+a.getMilliseconds(),e.timemod=e.CreatedAt.replace("T"," ").replace("Z","").substring(0,19),""===e.class||"grey"===e.class?t.greyitems.push(e):"white"===e.class?(t.whiteitems.push(e),e.allowed&&(e.allow='<i class="nb-checkmark"></i>')):t.blackitems.push(e)})),t.loading=!1})).catch((function(t){console.log("ERROR response: "+t)}))},makeWhite:function(t){var e=this,a=this;t.class="white",t.scan=!0,s["a"].put("http/"+t.ID,t).then((function(t){a.update(),e.$notification.success("HTTP(S) entry moved to white list!")})).catch((function(t){console.log("ERROR response: "+t)}))},makeBlack:function(t){var e=this,a=this;t.class="black",s["a"].put("http/"+t.ID,t).then((function(t){a.update(),e.$notification.success("HTTP(S) entry moved to black list!")})).catch((function(t){console.log("ERROR response: "+t)}))},makeGrey:function(t){var e=this,a=this;t.class="grey",s["a"].put("http/"+t.ID,t).then((function(t){a.update(),e.$notification.success("HTTP(S) entry moved to grey list!")})).catch((function(t){console.log("ERROR response: "+t)}))},deleteGrey:function(t){var e=this,a=this;s["a"].delete("http/"+t.ID).then((function(t){console.log("response: "+JSON.stringify(t)),a.update(),e.$notification.success("HTTP(S) entry deleted from grey list!")})).catch((function(t){console.log("ERROR response: "+t)}))},pruneEntries:function(){var t=this,e=this;s["a"].get("http/prune").then((function(a){e.update(),t.$notification.success("HTTP(S) entries pruned!")})).catch((function(t){console.log("ERROR response: "+t)}))},editItem:function(t){this.editedIndex=this.items.indexOf(t),this.editedItem=Object.assign({},t),console.log("editedItem: "+JSON.stringify(this.editedItem)),this.dialog=!0},close:function(){var t=this;this.dialog=!1,this.$nextTick((function(){t.editedItem=Object.assign({},t.defaultItem),t.editedIndex=-1}))},save:function(){var t=this;this.editedIndex>-1&&(Object.assign(this.items[this.editedIndex],this.editedItem),s["a"].put("http/"+this.editedIndex.ID,this.editedItem).then((function(e){t.$notification.success("HTTP entry updated!")})).catch((function(e){t.$notification.error("Failed to update HTTP entry!")}))),this.close()},saveItem:function(t){var e=this;s["a"].put("http/"+t.ID,t).then((function(t){e.$notification.success("HTTP entry updated!")})).catch((function(t){e.$notification.error("Failed to update HTTP entry!")})),this.close()}}},o=c,l=(a("b30d"),a("2877")),r=a("6544"),d=a.n(r),u=a("8336"),m=a("b0af"),h=a("99d9"),v=a("ac7c"),f=a("62ad"),p=a("a523"),b=a("8fea"),k=a("169a"),w=a("132d"),x=a("0fd9"),g=a("9e88"),I=a("2fa4"),y=a("71a3"),T=a("c671"),C=a("fe57"),R=a("aac8"),V=a("9a96"),_=a("8654"),S=a("71d9"),E=Object(l["a"])(o,i,n,!1,null,null,null);e["default"]=E.exports;d()(E,{VBtn:u["a"],VCard:m["a"],VCardActions:h["a"],VCardText:h["b"],VCardTitle:h["c"],VCheckbox:v["a"],VCol:f["a"],VContainer:p["a"],VDataTable:b["a"],VDialog:k["a"],VIcon:w["a"],VRow:x["a"],VSimpleCheckbox:g["a"],VSpacer:I["a"],VTab:y["a"],VTabItem:T["a"],VTabs:C["a"],VTabsItems:R["a"],VTabsSlider:V["a"],VTextField:_["a"],VToolbar:S["a"]})},ef52:function(t,e,a){}}]);
//# sourceMappingURL=views-BaselineHTTP.42725d45.js.map